# 论文对齐与理论一致性核查（2026-02-18）

## 1. 结论

- 已按核心论文路线逐项核对并修正关键实现偏差；
- 当前代码满足“主方程形式、耦合结构、门控判据”的一致性要求；
- 仍存在少量工程近似（已显式标注），不影响当前流程可用性，但不应宣称“严格无偏差”。

## 2. 主要对齐论文与链接

1. FNO（神经算子基础）
   - https://arxiv.org/abs/2010.08895
2. PINO（物理约束算子学习）
   - https://arxiv.org/abs/2111.03794
3. U-AFNO（相场加速）
   - https://www.nature.com/articles/s41524-024-01488-z
4. Phase-Field DeepONet（梯度流相场算子学习）
   - https://www.sciencedirect.com/science/article/pii/S0045782523004231
5. 溶解驱动 SCC 相场（力-化学耦合）
   - https://www.sciencedirect.com/science/article/abs/pii/S0022509620304622
6. Mg 合金点蚀/力学辅助腐蚀相场
   - https://doi.org/10.1016/j.actbio.2023.04.011
7. Mg 孪晶-孪晶 CP-TPF（多变体）
   - https://doi.org/10.1016/j.ijmecsci.2024.109734

## 3. 代码对齐清单（核心）

### 3.1 相场与扩散主方程

- Allen-Cahn 非守恒项已采用：
  - `phi_t = -L_phi * (dF/dphi)`，梯度项为 `+L_phi*kappa*lap(phi)`，未再使用错误通量形式。
- 浓度方程采用化学势一致形式：
  - `mu = A*(c - h(phi)*(cs-cl) - cl)`；
  - `c_t = div(M grad mu)`, `M = D/A`。
- 对应实现：
  - `mg_coupled_pf/simulator.py`
  - `mg_coupled_pf/operators.py`

### 3.2 力学-腐蚀-孪晶耦合

- 应力驱动腐蚀使用固相应力口径（避免界面掩膜导致驱动失真）；
- 孪晶多变体路径已接入（`eta_v*` + 竞争项 + 约束）；
- 力学采用各向异性 HCP 框架可选，并与孪晶重取向接口兼容。
- 对应实现：
  - `mg_coupled_pf/mechanics.py`
  - `mg_coupled_pf/crystal_plasticity.py`
  - `mg_coupled_pf/simulator.py`

### 3.3 ML 路线与门控

- 新增 U-AFNO 混合主干与多保真校正头：
  - `mg_coupled_pf/multiscale/advanced_models.py`
- 训练时加入边界软约束、多保真联合损失：
  - `mg_coupled_pf/multiscale/advanced_train.py`
- 评估引入 PCI（越界率+单调性+不确定性校准）：
  - `mg_coupled_pf/multiscale/physics_metrics.py`

## 4. 仍保留的工程近似（已知）

1. 未全面实现有限应变孪晶运动学（当前主链路仍为小应变框架）。
2. 宏观 surrogate 的“物理约束”主要通过门控与指标评估实现，尚非完整 PINO 端到端残差训练。
3. 闭环设计当前采用“surrogate 候选 + physics 验证 + 局部再优化”，已可用但仍可进一步引入主动误差上界控制。

## 5. 核查立场

- 现阶段可确认：关键理论口径与实现路径一致，且主要历史硬伤已修复；
- 不能宣称“没有一点偏差”，应表述为“关键方程与耦合口径已对齐，工程近似项已显式管理并可追踪”。
