# 70篇文献合并综述与完整公式推导（2026-02-18）

## 摘要
本文合并以下两份文档并重写为统一版本：
- `docs/50篇顶刊文献审查与理论结论_20260218.md`
- `docs/补充20篇顶刊回顾与本工作推理链_20260218.md`

在此基础上，给出镁合金“孪晶-晶体塑性-腐蚀耦合相场”核心公式的底层推导：从守恒律与自由能泛函出发，逐步到控制方程、离散形式、门控判据与代码实现。

## 1. 建模目标、推理前提与适用边界
### 1.1 目标
构建可用于微观组织演化与宏观腐蚀响应连接的统一模型：`phi-c-eta-u-epsp` 多场耦合。

### 1.2 推理前提
1. 几何与力学：二维、小应变、准静态力学平衡。
2. 相场变量：`phi` 为固/液（腐蚀）非守恒序参量；`eta_v` 为孪晶序参量（可多变体）。
3. 扩散变量：`c` 为归一化 Mg 离子浓度守恒场，采用化学势一致形式。
4. 机理耦合：腐蚀-应力耦合优先采用 mobility 路线；若启用全变分机械项，需保持能量-方程一致。
5. 数据条件：缺少实验大数据时，宏观 surrogate 由高保真物理仿真生成数据训练，并用物理门控保证正确性。

### 1.3 变量与符号
- `phi∈[0,1]`：腐蚀相场；`phi=1` 固相、`phi=0` 液相。
- `h(phi)=6phi^5-15phi^4+10phi^3`：平滑插值。
- `eta_v∈[0,1]`：第 `v` 个孪晶序参量；`f_twin,v=h(eta_v)` 为体积分数映射。
- `c`：归一化 Mg 浓度（液相初值 0，固相初值 1）。
- `u=(ux,uy)`：位移；`epsp`：塑性应变；`sigma`：应力。

## 2. 70篇文献逐篇顺序回顾（合并表）
- 合并后去重条目数：**70** 篇。
- 说明：每篇先给基本信息，再给“对本模型约束/启发”的一句话结论。

1. **1998，Journal of the Mechanics and Physics of Solids**：Incorporation of deformation twinning in crystal plasticity models  
   DOI: https://doi.org/10.1016/s0022-5096(97)00051-3  
   标签：晶体塑性、孪晶。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

2. **2003，International Journal of Plasticity**：A constitutive model for hcp materials deforming by slip and twinning  
   DOI: https://doi.org/10.1016/s0749-6419(03)00039-1  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

3. **2004，Materials Science and Engineering: A**：Corrosion resistance of aged die cast magnesium alloy AZ91D  
   DOI: https://doi.org/10.1016/j.msea.2003.08.060  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

4. **2005，Acta Materialia**：Twinning and the orientation relationships of icosahedral phase with the magnesium matrix  
   DOI: https://doi.org/10.1016/j.actamat.2005.06.026  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

5. **2005，Corrosion Science**：About some corrosion mechanisms of AZ91D magnesium alloy  
   DOI: https://doi.org/10.1016/j.corsci.2004.09.018  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

6. **2005，Materials Science and Engineering: A**：Modelling the motion of twinning dislocations in the HCP metals  
   DOI: https://doi.org/10.1016/j.msea.2005.01.067  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

7. **2006，Corrosion Science**：Roles of β phase in the corrosion process of AZ91D magnesium alloy  
   DOI: https://doi.org/10.1016/j.corsci.2005.05.011  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

8. **2007，Corrosion Science**：Corrosion product formation during NaCl induced atmospheric corrosion of magnesium alloy AZ91D  
   DOI: https://doi.org/10.1016/j.corsci.2006.08.004  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

9. **2007，Materials Science and Engineering: A**：Twinning and the ductility of magnesium alloys  
   DOI: https://doi.org/10.1016/j.msea.2007.02.109  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

10. **2007，Materials Science and Engineering: A**：Twinning and the ductility of magnesium alloys  
   DOI: https://doi.org/10.1016/j.msea.2006.12.037  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

11. **2008，Corrosion Science**：Atmospheric corrosion of field-exposed magnesium alloy AZ91D  
   DOI: https://doi.org/10.1016/j.corsci.2007.12.005  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

12. **2008，Corrosion Science**：Corrosion properties of surface-modified AZ91D magnesium alloy  
   DOI: https://doi.org/10.1016/j.corsci.2008.09.034  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

13. **2009，Corrosion Science**：Corrosion of friction stir welded magnesium alloy AM50  
   DOI: https://doi.org/10.1016/j.corsci.2009.04.031  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

14. **2010，Acta Biomaterialia**：In vivo corrosion and corrosion protection of magnesium alloy LAE442  
   DOI: https://doi.org/10.1016/j.actbio.2009.10.012  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

15. **2010，Acta Materialia**：Simulations of stress-induced twinning and de-twinning: A phase field model  
   DOI: https://doi.org/10.1016/j.actamat.2010.08.020  
   标签：相场、孪晶。结论：提供相场界面能、演化方程与离散策略支撑，用于验证方程项号和长度尺度定标。

16. **2010，Philosophical Magazine**：Statistical analyses of deformation twinning in magnesium  
   DOI: https://doi.org/10.1080/14786431003630835  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

17. **2011，Corrosion Science**：Corrosion of heat treated magnesium alloy ZE41  
   DOI: https://doi.org/10.1016/j.corsci.2011.06.005  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

18. **2011，Philosophical Magazine Letters**：A phase-field model for deformation twinning  
   DOI: https://doi.org/10.1080/09500839.2010.537284  
   标签：相场、孪晶。结论：提供相场界面能、演化方程与离散策略支撑，用于验证方程项号和长度尺度定标。

19. **2011，Philosophical Magazine Letters**：{ }-{ } Double twinning in magnesium  
   DOI: https://doi.org/10.1080/09500839.2011.593576  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

20. **2011，Scripta Materialia**：Deformation twinning in a nanocrystalline hcp Mg alloy  
   DOI: https://doi.org/10.1016/j.scriptamat.2010.10.024  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

21. **2012，Corrosion Science**：Corrosion behavior of fine-grained AZ31B magnesium alloy  
   DOI: https://doi.org/10.1016/j.corsci.2012.04.039  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

22. **2012，Scripta Materialia**：Twinning in magnesium-based lamellar microstructures  
   DOI: https://doi.org/10.1016/j.scriptamat.2012.06.035  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

23. **2013，Acta Materialia**：Phase-field analysis of fracture-induced twinning in single crystals  
   DOI: https://doi.org/10.1016/j.actamat.2013.05.023  
   标签：相场、孪晶。结论：提供相场界面能、演化方程与离散策略支撑，用于验证方程项号和长度尺度定标。

24. **2013，International Journal of Plasticity**：A crystal plasticity model for hexagonal close packed (HCP) crystals including twinning and de-twinning mechanisms  
   DOI: https://doi.org/10.1016/j.ijplas.2013.02.016  
   标签：晶体塑性、孪晶、镁/HCP。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

25. **2013，Scripta Materialia**：Nanoindentation study for deformation twinning of magnesium single crystal  
   DOI: https://doi.org/10.1016/j.scriptamat.2012.11.030  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

26. **2014，Computational Materials Science**：A phase-field model of twinning and detwinning coupled with dislocation-based crystal plasticity for HCP metals  
   DOI: https://doi.org/10.1016/j.commatsci.2014.08.034  
   标签：相场、晶体塑性、孪晶、镁/HCP。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

27. **2014，International Journal of Plasticity**：Thermostastitical modelling of deformation twinning in HCP metals  
   DOI: https://doi.org/10.1016/j.ijplas.2013.09.006  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

28. **2015，Acta Materialia**：Orientation dependent deformation by slip and twinning in magnesium during single crystal indentation  
   DOI: https://doi.org/10.1016/j.actamat.2015.01.046  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

29. **2015，International Journal of Plasticity**：A variational constitutive model for slip-twinning interactions in hcp metals: Application to single- and polycrystalline magnesium  
   DOI: https://doi.org/10.1016/j.ijplas.2015.03.008  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

30. **2016，Acta Materialia**：A crystal plasticity model for twinning- and transformation-induced plasticity  
   DOI: https://doi.org/10.1016/j.actamat.2016.07.032  
   标签：晶体塑性、孪晶。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

31. **2016，Acta Materialia**：Intragranular twinning, detwinning, and twinning-like lattice reorientation in magnesium alloys  
   DOI: https://doi.org/10.1016/j.actamat.2016.08.058  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

32. **2016，Acta Materialia**：On the role of anomalous twinning in the plasticity of magnesium  
   DOI: https://doi.org/10.1016/j.actamat.2015.10.043  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

33. **2016，Computational Materials Science**：Super-plasticity via secondary twinning in magnesium nanowire revealed by molecular dynamics simulations  
   DOI: https://doi.org/10.1016/j.commatsci.2015.09.016  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

34. **2016，Corrosion Science**：A phase field model for simulating the pitting corrosion  
   DOI: https://doi.org/10.1016/j.corsci.2016.04.001  
   标签：相场、腐蚀。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

35. **2016，Corrosion Science**：Composite magnesium phosphate coatings for improved corrosion resistance of magnesium AZ31 alloy  
   DOI: https://doi.org/10.1016/j.corsci.2016.10.010  
   标签：腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

36. **2016，International Journal of Plasticity**：A crystal plasticity modeling considering volume fraction of deformation twinning  
   DOI: https://doi.org/10.1016/j.ijplas.2016.05.002  
   标签：晶体塑性、孪晶。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

37. **2016，Scripta Materialia**：Grain size effects on dislocation and twinning mediated plasticity in magnesium  
   DOI: https://doi.org/10.1016/j.scriptamat.2015.09.008  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

38. **2017，Corrosion Science**：A phase field model for simulating the stress corrosion cracking initiated from pits  
   DOI: https://doi.org/10.1016/j.corsci.2017.06.006  
   标签：相场、腐蚀。结论：给出应力腐蚀/溶解驱动裂纹的相场耦合路径，可用于校正机械-化学耦合项。

39. **2018，Acta Materialia**：Crystal plasticity FEM study of twinning and slip in a Mg single crystal by Erichsen test  
   DOI: https://doi.org/10.1016/j.actamat.2018.06.042  
   标签：晶体塑性、孪晶、镁/HCP。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

40. **2018，Acta Materialia**：On the role of twinning and stacking faults on the crystal plasticity and grain refinement in magnesium alloys  
   DOI: https://doi.org/10.1016/j.actamat.2017.11.004  
   标签：晶体塑性、孪晶、镁/HCP。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

41. **2018，Journal of the Mechanics and Physics of Solids**：The mechanics of dynamic twinning in single crystal magnesium  
   DOI: https://doi.org/10.1016/j.jmps.2018.03.010  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

42. **2018，npj Computational Materials**：Phase-field model of pitting corrosion kinetics in metallic materials  
   DOI: https://doi.org/10.1038/s41524-018-0089-4  
   标签：相场、腐蚀。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

43. **2019，International Journal of Plasticity**：Resolving the diffusionless transformation process of twinning in single crystal plasticity theory  
   DOI: https://doi.org/10.1016/j.ijplas.2019.04.001  
   标签：晶体塑性、孪晶。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

44. **2020，Acta Materialia**：A study on crystal plasticity of face-centered cubic structures induced by deformation twinning  
   DOI: https://doi.org/10.1016/j.actamat.2020.07.040  
   标签：晶体塑性、孪晶。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

45. **2020，Corrosion Science**：Multi-phase-field modeling of localized corrosion involving galvanic pitting and mechano-electrochemical coupling  
   DOI: https://doi.org/10.1016/j.corsci.2020.108900  
   标签：相场、腐蚀。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

46. **2020，International Journal of Plasticity**：Multiscale modeling of twinning and detwinning behavior of HCP polycrystals  
   DOI: https://doi.org/10.1016/j.ijplas.2019.102653  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

47. **2021，Acta Materialia**：Coupled crystal plasticity finite element-phase field model with kinetics-controlled twinning mechanism for hexagonal metals  
   DOI: https://doi.org/10.1016/j.actamat.2020.11.002  
   标签：相场、晶体塑性、孪晶。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

48. **2021，International Journal of Plasticity**：Spectral phase-field model of deformation twinning and plastic deformation  
   DOI: https://doi.org/10.1016/j.ijplas.2021.103019  
   标签：相场、孪晶。结论：提供相场界面能、演化方程与离散策略支撑，用于验证方程项号和长度尺度定标。

49. **2021，Journal of the Mechanics and Physics of Solids**：A phase field formulation for dissolution-driven stress corrosion cracking  
   DOI: https://doi.org/10.1016/j.jmps.2020.104254  
   标签：相场、腐蚀。结论：给出应力腐蚀/溶解驱动裂纹的相场耦合路径，可用于校正机械-化学耦合项。

50. **2022，Computational Materials Science**：Comparison of three state-of-the-art crystal plasticity based deformation twinning models for magnesium alloys  
   DOI: https://doi.org/10.1016/j.commatsci.2022.111480  
   标签：晶体塑性、孪晶、镁/HCP。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

51. **2022，International Journal of Plasticity**：An efficient temperature-dependent crystal plasticity framework for pure magnesium with emphasis on the competition between slip and twinning  
   DOI: https://doi.org/10.1016/j.ijplas.2022.103448  
   标签：晶体塑性、孪晶、镁/HCP。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

52. **2022，International Journal of Plasticity**：Dual-interface model for twinning in the coupled crystal plasticity finite element – Phase field method  
   DOI: https://doi.org/10.1016/j.ijplas.2022.103441  
   标签：相场、晶体塑性、孪晶。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

53. **2022，International Journal of Plasticity**：Modeling crystal plasticity with an enhanced twinning–detwinning model to simulate cyclic behavior of AZ31B magnesium alloy at various temperatures  
   DOI: https://doi.org/10.1016/j.ijplas.2021.103190  
   标签：晶体塑性、孪晶、镁/HCP。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

54. **2022，Journal of the Mechanics and Physics of Solids**：A generalised, multi-phase-field theory for dissolution-driven stress corrosion cracking and hydrogen embrittlement  
   DOI: https://doi.org/10.1016/j.jmps.2022.104951  
   标签：相场、腐蚀。结论：给出应力腐蚀/溶解驱动裂纹的相场耦合路径，可用于校正机械-化学耦合项。

55. **2022，Journal of the Mechanics and Physics of Solids**：Crystal plasticity including a phase-field deformation twinning model for the high-rate deformation of cyclotetramethylene tetranitramine  
   DOI: https://doi.org/10.1016/j.jmps.2022.104872  
   标签：相场、晶体塑性、孪晶。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

56. **2022，Journal of the Mechanics and Physics of Solids**：Deformation twinning as a displacive transformation: Finite-strain phase-field model of coupled twinning and crystal plasticity  
   DOI: https://doi.org/10.1016/j.jmps.2022.104855  
   标签：相场、晶体塑性、孪晶。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

57. **2022，Journal of the Mechanics and Physics of Solids**：Polyphase crystal plasticity for high strain rate: Application to twinning and retwinning in tantalum  
   DOI: https://doi.org/10.1016/j.jmps.2022.104921  
   标签：晶体塑性、孪晶。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

58. **2023，Acta Biomaterialia**：Phase-field modeling of pitting and mechanically-assisted corrosion of Mg alloys for biomedical applications  
   DOI: https://doi.org/10.1016/j.actbio.2023.04.011  
   标签：相场、腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

59. **2023，Computational Materials Science**：A sensitivity analysis of twinning crystal plasticity finite element model using single crystal and poly crystal Zircaloy  
   DOI: https://doi.org/10.1016/j.commatsci.2023.112425  
   标签：晶体塑性、孪晶。结论：提供滑移-孪晶竞争与硬化规律，用于约束 CP 子模型中的流动法则和内变量更新。

60. **2023，Engineering with Computers**：Electro-chemo-mechanical phase field modeling of localized corrosion: theory and COMSOL implementation  
   DOI: https://doi.org/10.1007/s00366-023-01833-8  
   标签：相场、腐蚀。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

61. **2024，Acta Materialia**：Rate-independent mechanism of deformation twinning in single crystal magnesium  
   DOI: https://doi.org/10.1016/j.actamat.2024.120223  
   标签：孪晶、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

62. **2024，Computational Materials Science**：Phase field study of pitting corrosion: Electrochemical reactions and temperature dependence  
   DOI: https://doi.org/10.1016/j.commatsci.2024.113251  
   标签：相场、腐蚀。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

63. **2024，Corrosion Science**：A microstructure-sensitive electro-chemo-mechanical phase-field model of pitting and stress corrosion cracking  
   DOI: https://doi.org/10.1016/j.corsci.2024.112031  
   标签：相场、腐蚀。结论：给出应力腐蚀/溶解驱动裂纹的相场耦合路径，可用于校正机械-化学耦合项。

64. **2025，Computational Materials Science**：Phase field numerical model for simulating the diffusion controlled stress corrosion cracking phenomena in anisotropic material  
   DOI: https://doi.org/10.1016/j.commatsci.2024.113528  
   标签：相场、腐蚀。结论：给出应力腐蚀/溶解驱动裂纹的相场耦合路径，可用于校正机械-化学耦合项。

65. **2025，Computational Materials Science**：The role of anodic hydrogen evolution in magnesium alloy corrosion: A multiphase phase-field model approach  
   DOI: https://doi.org/10.1016/j.commatsci.2025.113933  
   标签：相场、腐蚀、镁/HCP。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

66. **2025，Engineering with Computers**：Electrochemical–chemical–mechanical phase field model for non-uniform corrosion-induced cracking considering the rust precipitation  
   DOI: https://doi.org/10.1007/s00366-025-02132-0  
   标签：相场、腐蚀。结论：提供腐蚀动力学、点蚀演化或电化学耦合建模依据，可用于校准腐蚀参数与边界条件。

67. **2025，International Journal of Plasticity**：A crystal plasticity-informed data-driven model for magnesium alloys  
   DOI: https://doi.org/10.1016/j.ijplas.2025.104480  
   标签：晶体塑性、镁/HCP。结论：提供材料机制或计算方法支撑，用于完善模型假设边界。

68. **2025，International Journal of Plasticity**：Deformation mechanism of non-textured and basal-textured polycrystalline Mg alloys: A coupled crystal plasticity-twinning phase field simulation  
   DOI: https://doi.org/10.1016/j.ijplas.2025.104312  
   标签：相场、晶体塑性、孪晶、镁/HCP。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

69. **2026，Computational Mechanics**：Deformation twinning as a displacive transformation: computational aspects of the phase-field model coupled with crystal plasticity  
   DOI: https://doi.org/10.1007/s00466-024-02533-w  
   标签：相场、晶体塑性、孪晶。结论：提供 CP-孪晶-相场一体化框架，直接约束本模型的 η 方程、硬化与应力反馈定义。

70. **2026，International Journal of Plasticity**：An interface-regularized phase field model for deformation twinning  
   DOI: https://doi.org/10.1016/j.ijplas.2025.104569  
   标签：相场、孪晶。结论：提供相场界面能、演化方程与离散策略支撑，用于验证方程项号和长度尺度定标。


## 3. 从最底层到控制方程：完整推导

### 3.1 起点：守恒律与耗散不等式
1. 质量守恒（浓度场）：

$$\frac{\partial c}{\partial t}+\nabla\cdot \mathbf{J}_c = 0$$

2. 非守恒序参量（相场/孪晶）采用广义梯度流：

$$\frac{\partial q}{\partial t}=-L_q\frac{\delta F}{\delta q},\quad q\in\{\phi,\eta_v\}$$

3. 准静态力学平衡（忽略惯性）：

$$\nabla\cdot\boldsymbol\sigma=\mathbf{0}$$

4. 线性不可逆热力学闭合：

$$\mathbf{J}_c=-M\nabla \mu,\quad \mu=\frac{\delta F}{\delta c}$$

据此，守恒场自动得到 Cahn-Hilliard/Fick-化学势形式：

$$\frac{\partial c}{\partial t}=\nabla\cdot\left(M\nabla\mu\right)$$

### 3.2 自由能泛函构造
取总自由能

$$F=\int_\Omega \left(f_{chem}+f_\phi+f_\eta+f_{el}+f_{couple}\right)\,dV$$

其中：
1. 化学能（归一化浓度口径）：

$$f_{chem}=\frac{A}{2}\left(c-c_{eq}(\phi)\right)^2,\quad c_{eq}(\phi)=h(\phi)(c_s^{eq}-c_l^{eq})+c_l^{eq}$$

2. 腐蚀相场能：

$$f_\phi=\omega\,W(\phi)+\frac{\kappa_\phi}{2}|\nabla\phi|^2,\quad W(\phi)=16\phi^2(1-\phi)^2$$

3. 孪晶能（多变体）：

$$f_\eta=\sum_v h(\phi)\left[W_\eta\eta_v^2(1-\eta_v)^2+\frac{\kappa_\eta}{2}|\nabla\eta_v|^2\right]+f_{int}(\{\eta_v\})$$

4. 弹性能：

$$f_{el}=\frac12\,\boldsymbol\sigma:\boldsymbol\varepsilon^e$$

5. 可选机械耦合项（仅在全变分模式）：

$$f_{couple}=-h(\phi)e_{mech},\quad e_{mech}=\frac12\boldsymbol\sigma:\boldsymbol\varepsilon$$

### 3.3 对 `c` 的变分：化学势推导
由 $f_{chem}$ 得

$$\mu=\frac{\delta F}{\delta c}=A\left(c-c_{eq}(\phi)\right)$$

代入守恒律：

$$\frac{\partial c}{\partial t}=\nabla\cdot\left(M\nabla\mu\right)$$

若定义扩散系数 $D=MA$，则可写为

$$\frac{\partial c}{\partial t}=\nabla\cdot\left(\frac{D}{A}\nabla\mu\right)$$

这正是代码中 `mu-form` 的依据。

### 3.4 对 `phi` 的变分：Allen-Cahn 腐蚀相场
逐项求导：
1. 化学项：

$$\frac{\partial f_{chem}}{\partial\phi}=-A\left(c-c_{eq}(\phi)\right)(c_s^{eq}-c_l^{eq})h\'(\phi)$$

2. 双阱项：

$$W\'(\phi)=32\phi(1-\phi)(1-2\phi),\quad \frac{\partial}{\partial\phi}(\omega W)=\omega W\'(\phi)$$

3. 梯度项：

$$\frac{\delta}{\delta\phi}\int\frac{\kappa_\phi}{2}|\nabla\phi|^2dV=-\kappa_\phi\nabla^2\phi$$

4. 若开启孪晶梯度耦合：

$$\frac{\partial}{\partial\phi}\left(\frac{\kappa_\eta}{2}h(\phi)|\nabla\eta|^2\right)=\frac{\kappa_\eta}{2}h\'(\phi)|\nabla\eta|^2$$

5. 若开启机械全变分项：

$$\frac{\partial}{\partial\phi}\left(-h(\phi)e_{mech}\right)=-h\'(\phi)e_{mech}$$

故

$$\frac{\partial\phi}{\partial t}=-L_\phi\left(\frac{\delta F}{\delta\phi}\right)=-L_\phi\left(\phi_{nonlin}-\kappa_\phi\nabla^2\phi\right)$$

注意：该式必须是 $L_\phi\nabla^2\phi$ 结构，不能写成 $\nabla\cdot(L_\phi\kappa_\phi\nabla\phi)$，否则会引入额外 $\nabla L_\phi\cdot\nabla\phi$ 假项。

### 3.5 对 `eta_v` 的变分：孪晶 TDGL
对每个变体 $v$：

$$\frac{\partial \eta_v}{\partial t}=-L_\eta\left(\frac{\delta F}{\delta\eta_v}\right)$$

势垒导数：

$$\frac{d}{d\eta_v}\left[\eta_v^2(1-\eta_v)^2\right]=2\eta_v(1-\eta_v)(1-2\eta_v)$$

梯度项导数：

$$\frac{\delta}{\delta\eta_v}\int\frac{\kappa_\eta h(\phi)}{2}|\nabla\eta_v|^2dV=-\nabla\cdot\left(\kappa_\eta h(\phi)\nabla\eta_v\right)$$

应力驱动和形核项在工程实现中常作为附加动力学源：

$$S_{tw,v}=h(\phi)\,\tau_v\,\gamma_{tw}\,h\'(\eta_v),\quad S_{nuc,v}=h(\phi)A_{nuc}\,\mathcal{N}(x)\,\langle\tau_v-\tau_{crss}\rangle_+$$

总式：

$$\frac{\partial \eta_v}{\partial t}=-L_\eta\left[2W_\eta h(\phi)\eta_v(1-\eta_v)(1-2\eta_v)-\nabla\cdot(\kappa_\eta h(\phi)\nabla\eta_v)-S_{tw,v}-S_{nuc,v}+S_{comp,v}\right]$$

### 3.6 力学方程的底层推导
1. 虚功原理：

$$\delta \Pi = \int_\Omega \boldsymbol\sigma: \delta\boldsymbol\varepsilon\,dV - \int_{\partial\Omega_t}\mathbf{t}\cdot\delta\mathbf{u}\,dS = 0$$

对任意 $\delta\mathbf{u}$ 成立，得到强式：

$$\nabla\cdot\boldsymbol\sigma=0$$

2. 应变分解（小应变）：

$$\boldsymbol\varepsilon^e=\boldsymbol\varepsilon(\mathbf{u})+\boldsymbol\varepsilon^{ext}-\boldsymbol\varepsilon^p-\boldsymbol\varepsilon^{tw}$$

$$\boldsymbol\varepsilon(\mathbf{u})=\frac12(\nabla\mathbf{u}+\nabla\mathbf{u}^T)$$

3. 孪晶本征应变（多变体）：

$$\boldsymbol\varepsilon^{tw}=\sum_v h(\eta_v)\,\gamma_{tw}\,\text{sym}(\mathbf{s}_v\otimes\mathbf{n}_v)$$

4. 本构：

$$\boldsymbol\sigma=\mathbb{C}:\boldsymbol\varepsilon^e$$

5. 平面应变：$\varepsilon_{zz}=0$；平面应力：$\sigma_{zz}=0$。

平面应力下需 Schur 补消元：设 Voigt 次序 $(xx,yy,zz,yz,xz,xy)$，则

$$\hat{\mathbf{C}}=\mathbf{C}_{\alpha\beta}-\mathbf{C}_{\alpha 3}\,C_{33}^{-1}\,\mathbf{C}_{3\beta},\quad \alpha,\beta\in\{1,2,6\}$$

即先由 $\sigma_{zz}=0$ 求 $\varepsilon_{zz}$，再回代到 $(\sigma_{xx},\sigma_{yy},\sigma_{xy})$。

### 3.7 晶体塑性（CP）推导
1. 分解剪应力：

$$\tau_\alpha=\mathbf{P}_\alpha:\boldsymbol\sigma,\quad \mathbf{P}_\alpha=\text{sym}(\mathbf{s}_\alpha\otimes\mathbf{n}_\alpha)$$

2. 速率型流动法则（过应力形式）：

$$\dot\gamma_\alpha=\gamma_0\,\text{sign}(\tau_\alpha/g_\alpha)\left\langle\left|\tau_\alpha/g_\alpha\right|-1\right\rangle^m$$

3. 塑性应变率：

$$\dot{\boldsymbol\varepsilon}^p=\sum_\alpha \dot\gamma_\alpha\mathbf{P}_\alpha$$

4. 硬化：

$$\dot g_\alpha=h\sum_\beta q_{\alpha\beta}|\dot\gamma_\beta|$$

5. 等效塑性应变率（J2）：

$$\dot\varepsilon_{eq}=\sqrt{\frac{2}{3}\dot{\boldsymbol\varepsilon}^{p,dev}:\dot{\boldsymbol\varepsilon}^{p,dev}}$$

二维实现中取塑性不可压近似 $\dot\varepsilon^p_{zz}=-(\dot\varepsilon^p_{xx}+\dot\varepsilon^p_{yy})$ 后计算 J2。

### 3.8 腐蚀-应力耦合项的推导口径
基于过渡态近似，应力降低反应势垒可写成指数放大：

$$\mathcal{M}_\sigma=\exp\left(\frac{\sigma_h\Omega}{RT}\right)$$

考虑塑性活动对膜破坏/活性位点的影响，采用速率放大因子：

$$\mathcal{M}_{\dot\varepsilon}=1+k_{\dot\varepsilon}\tanh\left(\frac{\dot\varepsilon_{eq}}{\dot\varepsilon_{ref}}\right)$$

总 mobility：

$$L_\phi=L_0\,p(x)\,\mathcal{M}_\sigma\,\mathcal{M}_{\dot\varepsilon}$$

其中 $p(x)$ 为点蚀随机场。

## 4. 从连续模型到离散算法
### 4.1 非均匀网格二阶导数
对内点 $x_i$，记 $h_1=x_i-x_{i-1},h_2=x_{i+1}-x_i$：

$$f\'(x_i)\approx -\frac{h_2}{h_1(h_1+h_2)}f_{i-1}+\frac{h_2-h_1}{h_1h_2}f_i+\frac{h_1}{h_2(h_1+h_2)}f_{i+1}$$

$$f\''(x_i)\approx 2\left[\frac{f_{i-1}}{h_1(h_1+h_2)}-\frac{f_i}{h_1h_2}+\frac{f_{i+1}}{h_2(h_1+h_2)}\right]$$

### 4.2 守恒 FV 扩散通量
面通量：

$$J_{i+1/2}=-D_{i+1/2}\frac{u_{i+1}-u_i}{\Delta x_{i+1/2}},\quad D_{i+1/2}=\frac{2D_iD_{i+1}}{D_i+D_{i+1}}$$

控制体散度：

$$\left[\nabla\cdot(D\nabla u)\right]_i\approx\frac{J_{i+1/2}-J_{i-1/2}}{\Delta x_i}$$

### 4.3 phi 的 IMEX-L0 分裂推导
连续式：$\phi_t=-L(\phi_{nonlin}-\kappa\nabla^2\phi)$。令 $L_0$ 为常数上界，写成

$$\frac{\phi^{n+1}-\phi^n}{\Delta t}=-L^n\phi_{nonlin}^n+L^n\kappa\nabla^2\phi^n+L_0\kappa(\nabla^2\phi^{n+1}-\nabla^2\phi^n)$$

整理得 Helmholtz 形式：

$$\left(I-\Delta tL_0\kappa\nabla^2\right)\phi^{n+1}=\phi^n-\Delta tL^n\phi_{nonlin}^n+\Delta t(L^n-L_0)\kappa\nabla^2\phi^n$$

这样保持了 AC 的正确算子结构，同时提升稳定性。

## 5. 机器学习加速的正确性推导与判据
### 5.1 surrogate 仅在物理门控通过时接受
设候选状态为 $\hat{X}^{n+1}$，接受条件：

1. PDE 无量纲残差：

$$R_\phi=\frac{|(\hat\phi^{n+1}-\phi^n)/\Delta t+\mathcal{A}_\phi(\hat X^{n+1})|}{1/\Delta t}<\epsilon_\phi$$

$$R_c=\frac{|(\hat c^{n+1}-c^n)/\Delta t-\mathcal{A}_c(\hat X^{n+1})|}{(c_{max}-c_{min})/\Delta t}<\epsilon_c$$

$$R_\eta,R_{mech}\ \text{同理}$$

2. 守恒约束：$|\bar c^{n+1}-\bar c^n|<\epsilon_m$。
3. 能量约束（适用时）：$E_{gate}^{n+1}-E_{gate}^{n}\le \epsilon_E$。

否则回退到物理步。

### 5.2 无实验宏观数据时的可验证指标
1. 守恒误差（mass drift）。
2. PDE 残差统计（全局+局部）。
3. 关键物理量轨迹差：腐蚀前沿、固相分数、应力峰值、孪晶体积分数。
4. 锚定步对比误差（surrogate vs physics anchor）。

## 6. 代码映射（公式 -> 实现）
- $W(\phi),W\'(\phi),h(\phi)$：`mg_coupled_pf/operators.py`
- $\omega,\kappa_\phi$ 定标：`mg_coupled_pf/simulator.py` 的 `_omega_kappa_phi`
- $\mu$-form 扩散：`mg_coupled_pf/simulator.py` 的 `_diffusion_rhs`
- AC/IMEX-L0：`mg_coupled_pf/simulator.py` 中 `phi_nonlin` 与 IMEX 更新段
- 孪晶多变体 TDGL：`mg_coupled_pf/simulator.py` 中 `eta_variants` 更新段
- 力学平衡与本构：`mg_coupled_pf/mechanics.py`
- CP 流动与硬化：`mg_coupled_pf/crystal_plasticity.py`
- surrogate 物理门控：`mg_coupled_pf/simulator.py` 的 `_compute_pde_residuals` 与 `step`

## 7. 本工作与文献的对应关系（先回顾后提出）
1. 文献回顾得到的共识：
   - 腐蚀相场需守恒扩散与界面动力学一致；
   - 孪晶与 CP 的耦合必须保持内变量闭合；
   - 应力耦合若非全变分，需通过门控与校准控制误差。
2. 本工作在此前提下的实现：
   - 使用 `phi-c-eta-u-epsp` 统一框架；
   - 采用可回退的 ML 加速而非无约束替代；
   - 保留电场/氢脆接口，便于后续拓展。

## 8. 仍需继续推进的严格化方向
1. 有限应变孪晶相变运动学（替代小应变近似）。
2. 更严格电化学-力学全变分闭合（超越 mobility-only）。
3. 宏观 surrogate 的不确定性传播与长时外推误差界。
