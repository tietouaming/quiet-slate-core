# 相场理论与全局参数总表

> 本文档由脚本自动生成：`scripts/export_phasefield_theory_params.py`。
> 修改全局参数后重新执行该脚本，即可同步更新所有参数表。

## 一、理论方程（与代码实现一致）

1. 腐蚀相场（Allen-Cahn 非守恒形式）

```text
∂phi/∂t = -L_phi * ( d(f_chem+f_dw)/dphi - kappa_phi * ∇²phi + coupling_terms )
```

2. 镁离子归一化浓度扩散（守恒形式）

```text
mu_c = A * (cMg - h(phi)*(c_s_eq-c_l_eq) - c_l_eq)
∂cMg/∂t = ∇·( M(phi) ∇mu_c )
M = D / A
```

3. 孪晶序参量（TDGL / Allen-Cahn 形式）

```text
∂eta/∂t = -L_eta * ( d(f_eta)/deta - kappa_eta * ∇²eta - tau_tw*gamma_twin*dh(eta)/deta )
```

4. 力学平衡（准静态）

```text
∇·sigma = 0
sigma = C : (eps(u) - eps_p - eps_tw)
```

5. 晶体塑性（速率型）

```text
gamma_dot = gamma0 * <|tau/g| - 1>^m * sign(tau)
eps_p_dot = Σ gamma_dot * sym(s ⊗ n)
```

## 二、参数统一修改方式

- 推荐统一在 `configs/notch_case.yaml` 修改。
- 运行脚本同步文档：

```powershell
python scripts/export_phasefield_theory_params.py --config configs/notch_case.yaml --output docs/相场理论与参数总表.md
```

## 三、全局参数总表

| 参数路径 | 类型 | 当前值 |
|---|---|---|
| `domain.nx` | `int` | `256` |
| `domain.ny` | `int` | `160` |
| `domain.lx_um` | `float` | `400` |
| `domain.ly_um` | `float` | `250` |
| `domain.solid_phase_threshold` | `float` | `0.5` |
| `domain.mesh_refine_near_notch` | `bool` | `False` |
| `domain.mesh_refine_strength_x` | `float` | `8` |
| `domain.mesh_refine_strength_y` | `float` | `6` |
| `domain.mesh_refine_sigma_x_um` | `float` | `30` |
| `domain.mesh_refine_sigma_y_um` | `float` | `20` |
| `domain.mesh_refine_samples` | `int` | `20000` |
| `domain.initial_geometry` | `str` | `notch` |
| `domain.notch_tip_x_um` | `float` | `80` |
| `domain.notch_center_y_um` | `float` | `125` |
| `domain.notch_depth_um` | `float` | `55` |
| `domain.notch_half_opening_um` | `float` | `28` |
| `domain.interface_width_um` | `float` | `2` |
| `domain.initial_pit_sigma_um` | `float` | `-1` |
| `domain.initial_pit_radius_um` | `float` | `1.5` |
| `domain.add_initial_pit_seed` | `bool` | `True` |
| `domain.half_space_direction` | `str` | `x` |
| `domain.half_space_interface_x_um` | `float` | `-1` |
| `domain.half_space_interface_y_um` | `float` | `-1` |
| `domain.half_space_solid_on_lower_side` | `bool` | `True` |
| `domain.add_half_space_triangular_notch` | `bool` | `False` |
| `domain.half_space_notch_tip_x_um` | `float` | `140` |
| `domain.half_space_notch_center_y_um` | `float` | `125` |
| `domain.half_space_notch_depth_um` | `float` | `100` |
| `domain.half_space_notch_half_opening_um` | `float` | `25` |
| `domain.half_space_notch_open_to_positive_x` | `bool` | `True` |
| `domain.half_space_notch_sharpness_um` | `float` | `0.25` |
| `domain.tip_zoom_width_um` | `float` | `12` |
| `domain.tip_zoom_height_um` | `float` | `9` |
| `numerics.dt_s` | `float` | `0.0001` |
| `numerics.n_steps` | `int` | `1200` |
| `numerics.save_every` | `int` | `100` |
| `numerics.mechanics_substeps` | `int` | `12` |
| `numerics.mechanics_adaptive_substeps` | `bool` | `False` |
| `numerics.mechanics_min_substeps` | `int` | `2` |
| `numerics.mechanics_residual_tol` | `float` | `0` |
| `numerics.mechanics_residual_rel_tol` | `float` | `0` |
| `numerics.mechanics_relaxation` | `float` | `0.22` |
| `numerics.seed` | `int` | `42` |
| `numerics.use_torch_compile` | `bool` | `True` |
| `numerics.mixed_precision` | `bool` | `False` |
| `numerics.inference_mode` | `bool` | `True` |
| `numerics.dtype` | `str` | `float32` |
| `numerics.diffusion_auto_substeps` | `bool` | `True` |
| `numerics.diffusion_dt_safety` | `float` | `0.9` |
| `numerics.diffusion_substeps_cap` | `int` | `256` |
| `numerics.diffusion_integrator` | `str` | `subcycled_euler` |
| `numerics.diffusion_sts_nu` | `float` | `0.05` |
| `numerics.diffusion_sts_max_stages` | `int` | `128` |
| `numerics.mechanics_update_every` | `int` | `1` |
| `numerics.phi_integrator` | `str` | `imex_helmholtz` |
| `numerics.eta_integrator` | `str` | `imex_variable` |
| `numerics.phi_imex_l0_strategy` | `str` | `max` |
| `numerics.phi_imex_l0_quantile` | `float` | `0.95` |
| `numerics.phi_imex_l0_safety` | `float` | `1.05` |
| `numerics.imex_solver_iters` | `int` | `80` |
| `numerics.imex_solver_tol_abs` | `float` | `1e-08` |
| `numerics.imex_solver_tol_rel` | `float` | `1e-05` |
| `numerics.imex_relaxation` | `float` | `1` |
| `numerics.scalar_linear_solver` | `str` | `auto` |
| `numerics.mechanics_solver` | `str` | `hybrid_cg_relax` |
| `numerics.mechanics_cg_max_iters` | `int` | `120` |
| `numerics.mechanics_cg_tol_abs` | `float` | `5` |
| `numerics.mechanics_cg_tol_rel` | `float` | `0.005` |
| `numerics.mechanics_cg_diag_shift` | `float` | `1e-06` |
| `numerics.mechanics_krylov_method` | `str` | `gmres` |
| `numerics.mechanics_gmres_restart` | `int` | `24` |
| `numerics.mechanics_gmres_max_restarts` | `int` | `6` |
| `numerics.mechanics_krylov_fail_streak_to_pause` | `int` | `3` |
| `numerics.mechanics_krylov_pause_steps` | `int` | `30` |
| `numerics.mechanics_use_ml_initial_guess` | `bool` | `False` |
| `numerics.scalar_bc` | `str` | `neumann` |
| `numerics.mechanics_trigger_phi_max_delta` | `float` | `0` |
| `numerics.mechanics_trigger_eta_max_delta` | `float` | `0` |
| `numerics.concentration_mass_projection` | `bool` | `False` |
| `numerics.concentration_mass_projection_iters` | `int` | `2` |
| `corrosion.D_l_m2_s` | `float` | `1e-10` |
| `corrosion.D_s_m2_s` | `float` | `1e-13` |
| `corrosion.c_l_eq_mol_L` | `float` | `0.57` |
| `corrosion.c_s_eq_mol_L` | `float` | `71.44` |
| `corrosion.c_l_eq_norm` | `float` | `0` |
| `corrosion.c_s_eq_norm` | `float` | `1` |
| `corrosion.cMg_init_liquid` | `float` | `0` |
| `corrosion.cMg_init_solid` | `float` | `1` |
| `corrosion.cMg_min` | `float` | `0` |
| `corrosion.cMg_max` | `float` | `1` |
| `corrosion.gamma_J_m2` | `float` | `0.5` |
| `corrosion.interface_thickness_definition` | `str` | `tanh_half_width` |
| `corrosion.interface_thickness_um` | `float` | `4` |
| `corrosion.A_J_m3` | `float` | `60000000` |
| `corrosion.temperature_K` | `float` | `310.15` |
| `corrosion.molar_volume_m3_mol` | `float` | `1.3998e-05` |
| `corrosion.gas_constant_J_mol_K` | `float` | `8.3144626` |
| `corrosion.L0` | `float` | `5e-08` |
| `corrosion.L0_unit` | `str` | `1_over_MPa_s` |
| `corrosion.pitting_beta` | `float` | `0.75` |
| `corrosion.pitting_alpha` | `float` | `3` |
| `corrosion.pitting_N` | `int` | `2` |
| `corrosion.pitting_min_factor` | `float` | `0.2` |
| `corrosion.pitting_max_factor` | `float` | `5` |
| `corrosion.yield_strain_for_mech` | `float` | `0.002` |
| `corrosion.use_epspeq_rate_for_mobility` | `bool` | `True` |
| `corrosion.epspeq_dot_ref_s_inv` | `float` | `0.001` |
| `corrosion.k_epsdot` | `float` | `1` |
| `corrosion.epspeq_twin_weight` | `float` | `1` |
| `corrosion.use_solid_sigma_for_corrosion` | `bool` | `True` |
| `corrosion.include_mech_term_in_phi_variation` | `bool` | `False` |
| `corrosion.include_twin_grad_term_in_phi_variation` | `bool` | `False` |
| `corrosion.include_mech_term_in_free_energy` | `bool` | `False` |
| `corrosion.concentration_use_mu_form` | `bool` | `True` |
| `twinning.L_eta` | `float` | `0.1295` |
| `twinning.W_barrier_MPa` | `float` | `8.86` |
| `twinning.kappa_eta` | `float` | `0.006` |
| `twinning.gamma_twin` | `float` | `0.129` |
| `twinning.twin_crss_MPa` | `float` | `30` |
| `twinning.twin_hcp_c_over_a` | `float` | `1.624` |
| `twinning.twin_systems_file` | `str` | `configs/twin_systems_hcp_3d.json` |
| `twinning.twin_variant_index` | `int` | `0` |
| `twinning.n_variants` | `int` | `1` |
| `twinning.twin_variant_indices` | `List[int]` | `[]` |
| `twinning.variant_competition_MPa` | `float` | `0` |
| `twinning.enforce_variant_sum_le_one` | `bool` | `True` |
| `twinning.twin_shear_dir_angle_deg` | `float` | `35` |
| `twinning.twin_plane_normal_angle_deg` | `float` | `125` |
| `twinning.scale_twin_gradient_by_hphi` | `bool` | `True` |
| `twinning.nucleation_source_amp` | `float` | `0.0002` |
| `twinning.langevin_nucleation_noise` | `float` | `0.0002` |
| `twinning.nucleation_center_radius_um` | `float` | `3` |
| `crystal_plasticity.gamma0_s_inv` | `float` | `1` |
| `crystal_plasticity.m_rate_sensitivity` | `float` | `20` |
| `crystal_plasticity.h_MPa` | `float` | `120` |
| `crystal_plasticity.q_latent` | `float` | `0.5` |
| `crystal_plasticity.use_overstress` | `bool` | `True` |
| `crystal_plasticity.gamma_dot_max_s_inv` | `float` | `50` |
| `crystal_plasticity.hardening_rate_cap_MPa_s` | `float` | `20000` |
| `crystal_plasticity.elastic_shortcut` | `bool` | `False` |
| `crystal_plasticity.basal_crss_MPa` | `float` | `13` |
| `crystal_plasticity.prismatic_crss_MPa` | `float` | `57` |
| `crystal_plasticity.pyramidal_crss_MPa` | `float` | `100` |
| `crystal_plasticity.hcp_c_over_a` | `float` | `1.624` |
| `crystal_plasticity.use_phase_dependent_strength` | `bool` | `True` |
| `crystal_plasticity.matrix_crss_scale` | `float` | `1` |
| `crystal_plasticity.twin_crss_scale` | `float` | `0.85` |
| `crystal_plasticity.matrix_hardening_scale` | `float` | `1` |
| `crystal_plasticity.twin_hardening_scale` | `float` | `1.2` |
| `crystal_plasticity.crystal_orientation_euler_deg` | `List[float]` | `[0, 0, 0]` |
| `crystal_plasticity.twin_reorientation_axis` | `List[float]` | `[0, 0, 1]` |
| `crystal_plasticity.twin_reorientation_angle_deg` | `float` | `86.3` |
| `crystal_plasticity.slip_systems_file` | `str` | `configs/slip_systems_hcp_3d.json` |
| `mechanics.C11_GPa` | `float` | `63.5` |
| `mechanics.C12_GPa` | `float` | `25.9` |
| `mechanics.C13_GPa` | `float` | `21.7` |
| `mechanics.C33_GPa` | `float` | `66.5` |
| `mechanics.C44_GPa` | `float` | `18.4` |
| `mechanics.lambda_GPa` | `float` | `38` |
| `mechanics.mu_GPa` | `float` | `16.3` |
| `mechanics.loading_mode` | `str` | `eigenstrain` |
| `mechanics.external_strain_x` | `float` | `0.001` |
| `mechanics.dirichlet_right_displacement_um` | `float` | `-1` |
| `mechanics.plane_strain` | `bool` | `True` |
| `mechanics.residual_damping_MPa_um` | `float` | `80` |
| `mechanics.max_abs_displacement_um` | `float` | `0` |
| `mechanics.max_abs_strain` | `float` | `0.1` |
| `mechanics.strict_solid_stress_only` | `bool` | `False` |
| `mechanics.use_anisotropic_hcp` | `bool` | `False` |
| `mechanics.crystal_orientation_euler_deg` | `List[float]` | `[0, 0, 0]` |
| `mechanics.twin_reorientation_axis` | `List[float]` | `[0, 0, 1]` |
| `mechanics.twin_reorientation_angle_deg` | `float` | `86.3` |
| `mechanics.anisotropic_blend_with_twin` | `bool` | `True` |
| `mechanics.mechanics_bc` | `str` | `neumann` |
| `mechanics.mechanics_bc_x` | `str` | `` |
| `mechanics.mechanics_bc_y` | `str` | `` |
| `ml.enabled` | `bool` | `True` |
| `ml.mode` | `str` | `predictor_corrector` |
| `ml.model_path` | `str` | `artifacts/ml/surrogate_latest.pt` |
| `ml.model_arch` | `str` | `tiny_unet` |
| `ml.surrogate_output_mode` | `str` | `delta` |
| `ml.model_hidden` | `int` | `32` |
| `ml.dw_hidden` | `int` | `24` |
| `ml.dw_depth` | `int` | `2` |
| `ml.fno_width` | `int` | `32` |
| `ml.fno_modes_x` | `int` | `24` |
| `ml.fno_modes_y` | `int` | `16` |
| `ml.fno_depth` | `int` | `4` |
| `ml.afno_width` | `int` | `24` |
| `ml.afno_modes_x` | `int` | `20` |
| `ml.afno_modes_y` | `int` | `12` |
| `ml.afno_depth` | `int` | `4` |
| `ml.afno_expansion` | `float` | `2` |
| `ml.train_epochs` | `int` | `30` |
| `ml.train_batch_size` | `int` | `8` |
| `ml.train_lr` | `float` | `0.0005` |
| `ml.train_split` | `float` | `0.9` |
| `ml.rollout_every` | `int` | `3` |
| `ml.residual_gate` | `float` | `0.5` |
| `ml.max_field_delta` | `float` | `0.06` |
| `ml.max_mean_phi_drop` | `float` | `0.002` |
| `ml.max_mean_eta_rise` | `float` | `0.01` |
| `ml.max_mean_phi_abs_delta` | `float` | `0.0008` |
| `ml.max_mean_eta_abs_delta` | `float` | `0.001` |
| `ml.max_mean_c_abs_delta` | `float` | `0.005` |
| `ml.max_mean_epspeq_abs_delta` | `float` | `0.0005` |
| `ml.enable_pde_residual_gate` | `bool` | `True` |
| `ml.pde_residual_phi_abs_max` | `float` | `0.08` |
| `ml.pde_residual_eta_abs_max` | `float` | `0.08` |
| `ml.pde_residual_c_abs_max` | `float` | `0.08` |
| `ml.pde_residual_mech_abs_max` | `float` | `120` |
| `ml.enable_local_pde_gate` | `bool` | `False` |
| `ml.local_pde_exceed_frac_max` | `float` | `0.02` |
| `ml.local_pde_phi_abs_max` | `float` | `0.2` |
| `ml.local_pde_eta_abs_max` | `float` | `0.2` |
| `ml.local_pde_c_abs_max` | `float` | `0.2` |
| `ml.local_pde_mech_abs_max` | `float` | `0.2` |
| `ml.enable_energy_gate` | `bool` | `True` |
| `ml.energy_gate_use_variational_core` | `bool` | `True` |
| `ml.energy_abs_increase_max` | `float` | `0.05` |
| `ml.energy_rel_increase_max` | `float` | `0.002` |
| `ml.enable_uncertainty_gate` | `bool` | `False` |
| `ml.uncertainty_samples` | `int` | `3` |
| `ml.uncertainty_jitter_std` | `float` | `0.0005` |
| `ml.uncertainty_gate` | `float` | `0.025` |
| `ml.surrogate_add_coord_features` | `bool` | `True` |
| `ml.surrogate_enforce_displacement_projection` | `bool` | `True` |
| `ml.mechanics_warmstart_enabled` | `bool` | `False` |
| `ml.mechanics_warmstart_model_path` | `str` | `artifacts/ml/mech_warmstart_latest.pt` |
| `ml.mechanics_warmstart_hidden` | `int` | `24` |
| `ml.mechanics_warmstart_add_coord_features` | `bool` | `True` |
| `ml.enable_mass_gate` | `bool` | `True` |
| `ml.mass_abs_delta_max` | `float` | `0.0001` |
| `ml.mass_rel_delta_max` | `float` | `0.0001` |
| `ml.enforce_mass_projection_on_accept` | `bool` | `False` |
| `ml.adaptive_rollout` | `bool` | `True` |
| `ml.rollout_min_every` | `int` | `1` |
| `ml.rollout_max_every` | `int` | `8` |
| `ml.rollout_success_streak_to_increase` | `int` | `6` |
| `ml.rollout_reject_streak_to_decrease` | `int` | `2` |
| `ml.enable_surrogate_mechanics_correction` | `bool` | `True` |
| `ml.anchor_physics_every` | `int` | `0` |
| `ml.max_consecutive_reject_before_pause` | `int` | `8` |
| `ml.pause_steps_after_reject_burst` | `int` | `120` |
| `ml.disable_surrogate_after_reject_burst` | `bool` | `True` |
| `ml.surrogate_delta_scale` | `float` | `1` |
| `ml.surrogate_update_mechanics_fields` | `bool` | `True` |
| `ml.surrogate_update_plastic_fields` | `bool` | `False` |
| `ml.surrogate_sync_cp_state_on_accept` | `bool` | `True` |
| `ml.enable_field_scaling` | `bool` | `True` |
| `extensions.enable_electric_field` | `bool` | `False` |
| `extensions.enable_hydrogen_embrittlement` | `bool` | `False` |
| `extensions.electric_field_strength_V_m` | `float` | `0` |
| `extensions.hydrogen_reference_ppm` | `float` | `0` |
| `runtime.device` | `str` | `auto` |
| `runtime.output_dir` | `str` | `artifacts/sim_notch` |
| `runtime.case_name` | `str` | `mg_notch_2d` |
| `runtime.clean_output` | `bool` | `True` |
| `runtime.render_intermediate_fields` | `bool` | `True` |
| `runtime.render_final_clouds` | `bool` | `True` |
| `runtime.render_grid_figure` | `bool` | `True` |
| `slip_systems` | `List[Dict[str, Any]]` | `[{'name': 'basal_1', 'family': 'basal', 'direction_mb': [2, -1, -1, 0], 'plane_mb': [0, 0, 0, 1], 's_crystal': [1.0, 0.0, 0.0], 'n_crystal': [0.0, 0.0, 1.0]}, {'name': 'basal_2', 'family': 'basal', 'direction_mb': [-1, 2, -1, 0], 'plane_mb': [0, 0, 0, 1], 's_crystal': [-0.5, 0.8660254037844387, 0.0], 'n_crystal': [0.0, 0.0, 1.0]}, {'name': 'basal_3', 'family': 'basal', 'direction_mb': [-1, -1, 2, 0], 'plane_mb': [0, 0, 0, 1], 's_crystal': [-0.5, -0.8660254037844387, 0.0], 'n_crystal': [0.0, 0.0, 1.0]}, {'name': 'prismatic_1', 'family': 'prismatic', 'direction_mb': [1, -2, 1, 0], 'plane_mb': [1, 0, -1, 0], 's_crystal': [0.5, -0.8660254037844387, 0.0], 'n_crystal': [0.8660254037844387, 0.5, 0.0]}, {'name': 'prismatic_2', 'family': 'prismatic', 'direction_mb': [-2, 1, 1, 0], 'plane_mb': [0, 1, -1, 0], 's_crystal': [-1.0, 0.0, 0.0], 'n_crystal': [0.0, 1.0, 0.0]}, {'name': 'prismatic_3', 'family': 'prismatic', 'direction_mb': [1, 1, -2, 0], 'plane_mb': [-1, 1, 0, 0], 's_crystal': [0.5, 0.8660254037844387, 0.0], 'n_crystal': [-0.8660254037844387, 0.5, 0.0]}, {'name': 'pyramidal_1', 'family': 'pyramidal', 'direction_mb': [0, -1, 1, 1], 'plane_mb': [1, 0, -1, 1], 's_crystal': [0.0, -0.7294946752841179, 0.6839864901678391], 'n_crystal': [0.7641611485231902, 0.4411886448041175, 0.47054257913989544]}, {'name': 'pyramidal_2', 'family': 'pyramidal', 'direction_mb': [-1, 0, 1, 1], 'plane_mb': [0, 1, -1, 1], 's_crystal': [-0.6317609207215262, -0.36474733764205897, 0.6839864901678391], 'n_crystal': [-1.8528144619652413e-17, 0.8823772896082351, 0.47054257913989544]}, {'name': 'pyramidal_3', 'family': 'pyramidal', 'direction_mb': [1, 0, -1, 1], 'plane_mb': [-1, 1, 0, 1], 's_crystal': [0.6317609207215262, 0.36474733764205897, 0.6839864901678391], 'n_crystal': [-0.7641611485231904, 0.4411886448041176, 0.4705425791398955]}, {'name': 'pyramidal_4', 'family': 'pyramidal', 'direction_mb': [0, 1, -1, -1], 'plane_mb': [-1, 0, 1, 1], 's_crystal': [0.0, 0.7294946752841179, -0.6839864901678391], 'n_crystal': [-0.9985291993197234, 0.0370834117893222, 0.03955071018294627]}, {'name': 'pyramidal_5', 'family': 'pyramidal', 'direction_mb': [1, 0, -1, -1], 'plane_mb': [0, -1, 1, 1], 's_crystal': [0.6317609207215262, 0.36474733764205897, -0.6839864901678391], 'n_crystal': [0.531379776328414, -0.8462099471367547, 0.03955071018294631]}, {'name': 'pyramidal_6', 'family': 'pyramidal', 'direction_mb': [-1, 0, 1, -1], 'plane_mb': [1, -1, 0, 1], 's_crystal': [-0.6317609207215262, -0.36474733764205897, -0.6839864901678391], 'n_crystal': [0.46714942299130935, -0.883293358926077, 0.03955071018294637]}]` |
| `twin_systems` | `List[Dict[str, Any]]` | `[{'name': 'ext_twin_1', 'direction_mb': [0, -2, 2, 1], 'plane_mb': [1, 0, -1, 2], 's_crystal': [0.0, -0.9054386071934437, 0.42447724156142547], 'n_crystal': [0.5923496763307038, 0.34199324508391954, 0.7294946752841179]}, {'name': 'ext_twin_2', 'direction_mb': [-2, 0, 2, 1], 'plane_mb': [0, 1, -1, 2], 's_crystal': [-0.7841328353967219, -0.4527193035967218, 0.4244772415614254], 'n_crystal': [-5.156773133480343e-17, 0.6839864901678391, 0.7294946752841178]}]` |
